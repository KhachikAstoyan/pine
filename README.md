This is just work in progress now, but I decided to push it here anyway
